# 캐시 메모리(Cache Memory)

![image](https://github.com/Nomad-CS-STUDY/CS_STUDY/assets/135118163/5e213ef1-df7c-4dcc-b166-76ee8935fd42)

## 캐시란?
- 주기억장치(RAM)와 CPU 사이에 존재하는 매우 빠른 메모리
- 빠른 장치(CPU)와 느린 장치(RAM)에서 속도 차이에 따른 병목 현상을 줄여주기 위한 메모리
- 주기억장치(RAM)에서 자주 요청되는 데이터와 명령을 저장하여 필요할 때 CPU에서 즉시 사용할 수 있도록 도와줌
- 주기억장치에 비해 비싸지만 CPU 레지스터보다는 경제적

## 지역성(Locality)
캐시 메모리는 주기억장치의 자주 사용되는 데이터를 저장하여 RAM에서 데이터에 접근하는 평균 시간을 줄여주는 데, 이를 위해서는 자주 사용되는 데이터가 어떤 데이터인지 판단할 수 있어야 합니다. 이를 판별하는 기준을 지역성(Locality)라고 합니다.

지역성은 공간 지역성(최근 사용된 데이터 혹은 그 데이터의 위치와 가까운 공간에 접근하는 특성)과 시간 지역성(최근에 사용한 데이터를 다시 사용하려는 특성)으로 구분됩니다. 

아래와 같은 예시 코드에서 for 반복문 안에서 변수 i에 계속해서 접근하는 것을 시간 지역성의 예로, 배열 arr의 각 요소 안에 i가 할당되면서 해당 배열에 접근하는 것을 공작 지역성의 예로 볼 수 있습니다.

```
 let arr = []

 for(let i = 0; i<5; i++){
    arr[i] = i;
 }
``` 

## 캐시히트와 캐시미스
- CPU가 참조하려는 데이터를 찾았다면 캐시히트
- CPU가 참조하려는 데이터가 없어서 주기억장치에서 데이터를 찾아오면 캐시미스
- 캐시 미스는 특정 데이터에 처음 접근할 때(Compulsory Miss), 캐시 메모리의 공간이 부족할 때(Capacity Miss), 캐시 메모리에 데이터를 저장할 때 특정한 데이터 끼리 같은 캐시 메모리 주소에 할당될 때(Conflict Miss) 발생한다.


## 캐시매핑
데이터를 찾기 위해 캐시를 하나 하나 찾는 것은 비효율적인 작업입니다. 때문에 캐시 히트를 높이기 위해서 캐시에 사용되는 방법을 캐시 매핑이라고 합니다.

### 직접 매핑(directed mapping)
- 주기억장치를 일정한 크기로 나누고, 나눈 조각들을 캐시에 매핑하는 방식
- 예를 들어 메모리가 1~100 이 있고 캐시가 1~10이 있다면 1:1~10, 2: 1~20....
- 처리가 빠르고 구현도 쉽지만 동일한 캐시 메모리에 할당된 여러 데이터를 사용할 때 충돌이 발생

### 연관 매핑(associative mapping)
- 순서를 일치시키지 않고 캐시 메미리의 빈 공간에 관련 있는 캐시와 메모리를 매핑하는 방식
- 충돌이 적지만 모든 블록을 탐색해야 해서 속도가 느리고 비용이 상승함

### 집한 연관 매핑(set associative mapping)
- 직접 매핑과 연관 매핑을 합쳐놓은 방식으로 주로 사용됨
- 미리 정해둔 특정한 행에 빈 공간이 생길때 마음대로 저장하는 방식
- 예를 들어 메모리가 1~100이 있고 캐시가 1~10이 있다면 캐시 1~2는 1~20의 데이터를 무작위로 저장
- 직접 매핑에 비해 검색 속도는 느리지만 저장이 빠르고, 연관 매밍에 비해 저장이 느리지만 검색은 빠름

---

> 참고
- https://gyoogle.dev/blog/computer-science/computer-architecture/%EC%BA%90%EC%8B%9C%20%EB%A9%94%EB%AA%A8%EB%A6%AC.html
- https://rebro.kr/180
- [그림 출처](https://www.crio.do/blog/cache-memory-explained/)